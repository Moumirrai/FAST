/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => Khoj
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  resultsCount: 6,
  khojUrl: "http://localhost:8000",
  connectedToBackend: false
};
var KhojSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("small", { text: this.getBackendStatusMessage() });
    new import_obsidian.Setting(containerEl).setName("Khoj URL").setDesc("The URL of the Khoj backend").addText((text) => text.setValue(`${this.plugin.settings.khojUrl}`).onChange(async (value) => {
      this.plugin.settings.khojUrl = value.trim();
      await this.plugin.saveSettings().finally(() => {
        var _a;
        return (_a = containerEl.firstElementChild) == null ? void 0 : _a.setText(this.getBackendStatusMessage());
      });
    }));
    new import_obsidian.Setting(containerEl).setName("Results Count").setDesc("The number of search results to show").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.resultsCount).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.resultsCount = value;
      await this.plugin.saveSettings();
    }));
    let indexVaultSetting = new import_obsidian.Setting(containerEl);
    indexVaultSetting.setName("Index Vault").setDesc("Manually force Khoj to re-index your Obsidian Vault").addButton((button) => button.setButtonText("Update").setCta().onClick(async () => {
      button.setButtonText("Updating...");
      button.removeCta();
      indexVaultSetting = indexVaultSetting.setDisabled(true);
      await (0, import_obsidian.request)(`${this.plugin.settings.khojUrl}/api/update?t=markdown&force=true`).then(() => new import_obsidian.Notice("\u2705 Updated Khoj index."));
      button.setButtonText("Update");
      button.setCta();
      indexVaultSetting = indexVaultSetting.setDisabled(false);
    }));
  }
  getBackendStatusMessage() {
    return !this.plugin.settings.connectedToBackend ? "\u2757Disconnected from Khoj backend. Ensure Khoj backend is running and Khoj URL is correctly set below." : "\u2705 Connected to Khoj backend.";
  }
};

// src/modal.ts
var import_obsidian2 = require("obsidian");
var KhojModal = class extends import_obsidian2.SuggestModal {
  constructor(app, setting, find_similar_notes = false) {
    super(app);
    this.rerank = false;
    this.setting = setting;
    this.find_similar_notes = find_similar_notes;
    this.inputEl.hidden = this.find_similar_notes;
    this.scope.register(["Mod"], "Enter", async () => {
      this.rerank = true;
      this.inputEl.dispatchEvent(new Event("input"));
      this.rerank = false;
    });
    const modalInstructions = [
      {
        command: "\u2191\u2193",
        purpose: "to navigate"
      },
      {
        command: "\u21B5",
        purpose: "to open"
      },
      {
        command: import_obsidian2.Platform.isMacOS ? "cmd \u21B5" : "ctrl \u21B5",
        purpose: "to rerank"
      },
      {
        command: "esc",
        purpose: "to dismiss"
      }
    ];
    this.setInstructions(modalInstructions);
    this.setPlaceholder("Search with Khoj \u{1F985}...");
  }
  async onOpen() {
    if (this.find_similar_notes) {
      let file = this.app.workspace.getActiveFile();
      if (file && file.extension === "md") {
        this.rerank = true;
        this.inputEl.value = await this.app.vault.read(file);
        this.inputEl.dispatchEvent(new Event("input"));
        this.rerank = false;
      } else {
        this.resultContainerEl.setText("Cannot find similar notes for non-markdown files");
      }
    }
  }
  async getSuggestions(query) {
    let encodedQuery = encodeURIComponent(query);
    let searchUrl = `${this.setting.khojUrl}/api/search?q=${encodedQuery}&n=${this.setting.resultsCount}&r=${this.rerank}&t=markdown`;
    let results = await (0, import_obsidian2.request)(searchUrl).then((response) => JSON.parse(response)).then((data) => data.filter((result) => {
      var _a;
      return !this.find_similar_notes || !result.additional.file.endsWith((_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.path);
    }).map((result) => {
      return { entry: result.entry, file: result.additional.file };
    }));
    return results;
  }
  async renderSuggestion(result, el) {
    let words_to_render = 30;
    let entry_words = result.entry.split(" ");
    let entry_snipped_indicator = entry_words.length > words_to_render ? " **...**" : "";
    let snipped_entry = entry_words.slice(0, words_to_render).join(" ");
    import_obsidian2.MarkdownRenderer.renderMarkdown(snipped_entry + entry_snipped_indicator, el, null, null);
  }
  async onChooseSuggestion(result, _) {
    const mdFiles = this.app.vault.getMarkdownFiles();
    mdFiles.sort((a, b) => b.path.length - a.path.length).forEach((file) => {
      if (result.file.endsWith(file.path)) {
        let resultHeading = result.entry.split("\n", 1)[0];
        let linkToEntry = `${file.path}${resultHeading}`;
        this.app.workspace.openLinkText(linkToEntry, "");
        console.log(`Link: ${linkToEntry}, File: ${file.path}, Heading: ${resultHeading}`);
        return;
      }
    });
  }
};

// src/utils.ts
var import_obsidian3 = require("obsidian");
function getVaultAbsolutePath() {
  let adaptor = this.app.vault.adapter;
  if (adaptor instanceof import_obsidian3.FileSystemAdapter) {
    return adaptor.getBasePath();
  }
  return "";
}
async function configureKhojBackend(setting, notify = true) {
  let mdInVault = `${getVaultAbsolutePath()}/**/*.md`;
  let khojConfigUrl = `${setting.khojUrl}/api/config/data`;
  let khoj_already_configured = await (0, import_obsidian3.request)(khojConfigUrl).then((response) => {
    setting.connectedToBackend = true;
    return response !== "null";
  }).catch((error) => {
    setting.connectedToBackend = false;
    if (notify)
      new import_obsidian3.Notice(`\u2757\uFE0FEnsure Khoj backend is running and Khoj URL is pointing to it in the plugin settings.

${error}`);
  });
  if (!setting.connectedToBackend)
    return;
  let indexName = getVaultAbsolutePath().replace(/\//g, "_").replace(/ /g, "_");
  let khojDefaultIndexDirectory = await (0, import_obsidian3.request)(`${khojConfigUrl}/default`).then((response) => JSON.parse(response)).then((data) => {
    return getIndexDirectoryFromBackendConfig(data);
  });
  await (0, import_obsidian3.request)(khoj_already_configured ? khojConfigUrl : `${khojConfigUrl}/default`).then((response) => JSON.parse(response)).then((data) => {
    if (!khoj_already_configured) {
      data["content-type"] = {
        "markdown": {
          "input-filter": [mdInVault],
          "input-files": null,
          "embeddings-file": `${khojDefaultIndexDirectory}/${indexName}.pt`,
          "compressed-jsonl": `${khojDefaultIndexDirectory}/${indexName}.jsonl.gz`
        }
      };
      delete data["processor"];
      updateKhojBackend(setting.khojUrl, data);
      console.log(`Khoj: Created khoj backend config:
${JSON.stringify(data)}`);
    } else if (!data["content-type"]["markdown"]) {
      data["content-type"]["markdown"] = {
        "input-filter": [mdInVault],
        "input-files": null,
        "embeddings-file": `${khojDefaultIndexDirectory}/${indexName}.pt`,
        "compressed-jsonl": `${khojDefaultIndexDirectory}/${indexName}.jsonl.gz`
      };
      updateKhojBackend(setting.khojUrl, data);
      console.log(`Khoj: Added markdown config to khoj backend config:
${JSON.stringify(data["content-type"])}`);
    } else if (data["content-type"]["markdown"]["input-filter"].length != 1 || data["content-type"]["markdown"]["input-filter"][0] !== mdInVault) {
      let khojIndexDirectory = getIndexDirectoryFromBackendConfig(data);
      data["content-type"]["markdown"] = {
        "input-filter": [mdInVault],
        "input-files": null,
        "embeddings-file": `${khojIndexDirectory}/${indexName}.pt`,
        "compressed-jsonl": `${khojIndexDirectory}/${indexName}.jsonl.gz`
      };
      updateKhojBackend(setting.khojUrl, data);
      console.log(`Khoj: Updated markdown config in khoj backend config:
${JSON.stringify(data["content-type"]["markdown"])}`);
    }
  }).catch((error) => {
    if (notify)
      new import_obsidian3.Notice(`\u2757\uFE0FFailed to configure Khoj backend. Contact developer on Github.

Error: ${error}`);
  });
}
async function updateKhojBackend(khojUrl, khojConfig) {
  let requestContent = {
    url: `${khojUrl}/api/config/data`,
    body: JSON.stringify(khojConfig),
    method: "POST",
    contentType: "application/json"
  };
  await (0, import_obsidian3.request)(requestContent).then((_) => (0, import_obsidian3.request)(`${khojUrl}/api/update?t=markdown`));
}
function getIndexDirectoryFromBackendConfig(khojConfig) {
  return khojConfig["content-type"]["markdown"]["embeddings-file"].split("/").slice(0, -1).join("/");
}

// src/main.ts
var Khoj = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    this.addCommand({
      id: "search",
      name: "Search",
      checkCallback: (checking) => {
        if (!checking && this.settings.connectedToBackend)
          new KhojModal(this.app, this.settings).open();
        return this.settings.connectedToBackend;
      }
    });
    this.addCommand({
      id: "similar",
      name: "Find Similar Notes",
      editorCheckCallback: (checking) => {
        if (!checking && this.settings.connectedToBackend)
          new KhojModal(this.app, this.settings, true).open();
        return this.settings.connectedToBackend;
      }
    });
    this.addRibbonIcon("search", "Khoj", (_) => {
      this.settings.connectedToBackend ? new KhojModal(this.app, this.settings).open() : new import_obsidian4.Notice(`\u2757\uFE0FEnsure Khoj backend is running and Khoj URL is pointing to it in the plugin settings`);
    });
    this.addSettingTab(new KhojSettingTab(this.app, this));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    await configureKhojBackend(this.settings);
  }
  async saveSettings() {
    await configureKhojBackend(this.settings, false).then(() => this.saveData(this.settings));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy9tb2RhbC50cyIsICJzcmMvdXRpbHMudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE5vdGljZSwgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgS2hvalNldHRpbmcsIEtob2pTZXR0aW5nVGFiLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnc3JjL3NldHRpbmdzJ1xuaW1wb3J0IHsgS2hvak1vZGFsIH0gZnJvbSAnc3JjL21vZGFsJ1xuaW1wb3J0IHsgY29uZmlndXJlS2hvakJhY2tlbmQgfSBmcm9tICcuL3V0aWxzJztcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLaG9qIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogS2hvalNldHRpbmc7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgLy8gQWRkIHNlYXJjaCBjb21tYW5kLiBJdCBjYW4gYmUgdHJpZ2dlcmVkIGZyb20gYW55d2hlcmVcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc2VhcmNoJyxcbiAgICAgICAgICAgIG5hbWU6ICdTZWFyY2gnLFxuICAgICAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFjaGVja2luZyAmJiB0aGlzLnNldHRpbmdzLmNvbm5lY3RlZFRvQmFja2VuZClcbiAgICAgICAgICAgICAgICAgICAgbmV3IEtob2pNb2RhbCh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncykub3BlbigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmNvbm5lY3RlZFRvQmFja2VuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWRkIHNpbWlsYXIgbm90ZXMgY29tbWFuZC4gSXQgY2FuIG9ubHkgYmUgdHJpZ2dlcmVkIGZyb20gdGhlIGVkaXRvclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzaW1pbGFyJyxcbiAgICAgICAgICAgIG5hbWU6ICdGaW5kIFNpbWlsYXIgTm90ZXMnLFxuICAgICAgICAgICAgZWRpdG9yQ2hlY2tDYWxsYmFjazogKGNoZWNraW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFjaGVja2luZyAmJiB0aGlzLnNldHRpbmdzLmNvbm5lY3RlZFRvQmFja2VuZClcbiAgICAgICAgICAgICAgICAgICAgbmV3IEtob2pNb2RhbCh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncywgdHJ1ZSkub3BlbigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmNvbm5lY3RlZFRvQmFja2VuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGFuIGljb24gaW4gdGhlIGxlZnQgcmliYm9uLlxuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oJ3NlYXJjaCcsICdLaG9qJywgKF86IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIENhbGxlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyB0aGUgaWNvbi5cbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuY29ubmVjdGVkVG9CYWNrZW5kXG4gICAgICAgICAgICAgICAgPyBuZXcgS2hvak1vZGFsKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKS5vcGVuKClcbiAgICAgICAgICAgICAgICA6IG5ldyBOb3RpY2UoYFx1Mjc1N1x1RkUwRkVuc3VyZSBLaG9qIGJhY2tlbmQgaXMgcnVubmluZyBhbmQgS2hvaiBVUkwgaXMgcG9pbnRpbmcgdG8gaXQgaW4gdGhlIHBsdWdpbiBzZXR0aW5nc2ApO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSBraG9qXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgS2hvalNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIC8vIExvYWQga2hvaiBvYnNpZGlhbiBwbHVnaW4gc2V0dGluZ3NcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cbiAgICAgICAgLy8gTG9hZCwgY29uZmlndXJlIGtob2ogc2VydmVyIHNldHRpbmdzXG4gICAgICAgIGF3YWl0IGNvbmZpZ3VyZUtob2pCYWNrZW5kKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgY29uZmlndXJlS2hvakJhY2tlbmQodGhpcy5zZXR0aW5ncywgZmFsc2UpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBOb3RpY2UsIFBsdWdpblNldHRpbmdUYWIsIHJlcXVlc3QsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgS2hvaiBmcm9tICdzcmMvbWFpbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgS2hvalNldHRpbmcge1xuICAgIHJlc3VsdHNDb3VudDogbnVtYmVyO1xuICAgIGtob2pVcmw6IHN0cmluZztcbiAgICBjb25uZWN0ZWRUb0JhY2tlbmQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBLaG9qU2V0dGluZyA9IHtcbiAgICByZXN1bHRzQ291bnQ6IDYsXG4gICAga2hvalVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODAwMCcsXG4gICAgY29ubmVjdGVkVG9CYWNrZW5kOiBmYWxzZSxcbn1cblxuZXhwb3J0IGNsYXNzIEtob2pTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBLaG9qO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogS2hvaikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgLy8gQWRkIG5vdGljZSB3aGV0aGVyIGFibGUgdG8gY29ubmVjdCB0byBraG9qIGJhY2tlbmQgb3Igbm90XG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdzbWFsbCcsIHsgdGV4dDogdGhpcy5nZXRCYWNrZW5kU3RhdHVzTWVzc2FnZSgpIH0pO1xuXG4gICAgICAgIC8vIEFkZCBraG9qIHNldHRpbmdzIGNvbmZpZ3VyYWJsZSBmcm9tIHRoZSBwbHVnaW4gc2V0dGluZ3MgdGFiXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0tob2ogVVJMJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUaGUgVVJMIG9mIHRoZSBLaG9qIGJhY2tlbmQnKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKGAke3RoaXMucGx1Z2luLnNldHRpbmdzLmtob2pVcmx9YClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmtob2pVcmwgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXG4gICAgICAgICAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IGNvbnRhaW5lckVsLmZpcnN0RWxlbWVudENoaWxkPy5zZXRUZXh0KHRoaXMuZ2V0QmFja2VuZFN0YXR1c01lc3NhZ2UoKSkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1Jlc3VsdHMgQ291bnQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1RoZSBudW1iZXIgb2Ygc2VhcmNoIHJlc3VsdHMgdG8gc2hvdycpXG4gICAgICAgICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgICAgICAgICAuc2V0TGltaXRzKDEsIDEwLCAxKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXN1bHRzQ291bnQpXG4gICAgICAgICAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlc3VsdHNDb3VudCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIGxldCBpbmRleFZhdWx0U2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKTtcbiAgICAgICAgaW5kZXhWYXVsdFNldHRpbmdcbiAgICAgICAgICAgIC5zZXROYW1lKCdJbmRleCBWYXVsdCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnTWFudWFsbHkgZm9yY2UgS2hvaiB0byByZS1pbmRleCB5b3VyIE9ic2lkaWFuIFZhdWx0JylcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdVcGRhdGUnKVxuICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRGlzYWJsZSBidXR0b24gd2hpbGUgdXBkYXRpbmcgaW5kZXhcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ1VwZGF0aW5nLi4uJyk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVDdGEoKVxuICAgICAgICAgICAgICAgICAgICBpbmRleFZhdWx0U2V0dGluZyA9IGluZGV4VmF1bHRTZXR0aW5nLnNldERpc2FibGVkKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHJlcXVlc3QoYCR7dGhpcy5wbHVnaW4uc2V0dGluZ3Mua2hvalVybH0vYXBpL3VwZGF0ZT90PW1hcmtkb3duJmZvcmNlPXRydWVgKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiBuZXcgTm90aWNlKCdcdTI3MDUgVXBkYXRlZCBLaG9qIGluZGV4LicpKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBSZS1lbmFibGUgYnV0dG9uIG9uY2UgaW5kZXggaXMgdXBkYXRlZFxuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dCgnVXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICBpbmRleFZhdWx0U2V0dGluZyA9IGluZGV4VmF1bHRTZXR0aW5nLnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICB9XG5cbiAgICBnZXRCYWNrZW5kU3RhdHVzTWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb25uZWN0ZWRUb0JhY2tlbmRcbiAgICAgICAgPyAnXHUyNzU3RGlzY29ubmVjdGVkIGZyb20gS2hvaiBiYWNrZW5kLiBFbnN1cmUgS2hvaiBiYWNrZW5kIGlzIHJ1bm5pbmcgYW5kIEtob2ogVVJMIGlzIGNvcnJlY3RseSBzZXQgYmVsb3cuJ1xuICAgICAgICA6ICdcdTI3MDUgQ29ubmVjdGVkIHRvIEtob2ogYmFja2VuZC4nO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFN1Z2dlc3RNb2RhbCwgcmVxdWVzdCwgTWFya2Rvd25SZW5kZXJlciwgSW5zdHJ1Y3Rpb24sIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgS2hvalNldHRpbmcgfSBmcm9tICdzcmMvc2V0dGluZ3MnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlYXJjaFJlc3VsdCB7XG4gICAgZW50cnk6IHN0cmluZztcbiAgICBmaWxlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBLaG9qTW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8U2VhcmNoUmVzdWx0PiB7XG4gICAgc2V0dGluZzogS2hvalNldHRpbmc7XG4gICAgcmVyYW5rOiBib29sZWFuID0gZmFsc2U7XG4gICAgZmluZF9zaW1pbGFyX25vdGVzOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHNldHRpbmc6IEtob2pTZXR0aW5nLCBmaW5kX3NpbWlsYXJfbm90ZXM6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnNldHRpbmcgPSBzZXR0aW5nO1xuICAgICAgICB0aGlzLmZpbmRfc2ltaWxhcl9ub3RlcyA9IGZpbmRfc2ltaWxhcl9ub3RlcztcblxuICAgICAgICAvLyBIaWRlIGlucHV0IGVsZW1lbnQgaW4gU2ltaWxhciBOb3RlcyBtb2RlXG4gICAgICAgIHRoaXMuaW5wdXRFbC5oaWRkZW4gPSB0aGlzLmZpbmRfc2ltaWxhcl9ub3RlcztcblxuICAgICAgICAvLyBSZWdpc3RlciBNb2RhbCBLZXliaW5kaW5ncyB0byBSZXJhbmsgUmVzdWx0c1xuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFsnTW9kJ10sICdFbnRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIFJlLXJhbmsgd2hlbiBleHBsaWNpdGx5IHRyaWdnZXJlZCBieSB1c2VyXG4gICAgICAgICAgICB0aGlzLnJlcmFuayA9IHRydWVcbiAgICAgICAgICAgIC8vIFRyaWdnZXIgaW5wdXQgZXZlbnQgdG8gZ2V0IGFuZCByZW5kZXIgKHJlcmFua2VkKSByZXN1bHRzIGZyb20ga2hvaiBiYWNrZW5kXG4gICAgICAgICAgICB0aGlzLmlucHV0RWwuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JykpO1xuICAgICAgICAgICAgLy8gUmVyYW5rIGRpc2FibGVkIGJ5IGRlZmF1bHQgdG8gc2F0aXNmeSBsYXRlbmN5IHJlcXVpcmVtZW50cyBmb3IgaW5jcmVtZW50YWwgc2VhcmNoXG4gICAgICAgICAgICB0aGlzLnJlcmFuayA9IGZhbHNlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBIaW50cyB0byBNb2RhbCBmb3IgYXZhaWxhYmxlIEtleWJpbmRpbmdzXG4gICAgICAgIGNvbnN0IG1vZGFsSW5zdHJ1Y3Rpb25zOiBJbnN0cnVjdGlvbltdID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdcdTIxOTFcdTIxOTMnLFxuICAgICAgICAgICAgICAgIHB1cnBvc2U6ICd0byBuYXZpZ2F0ZScsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdcdTIxQjUnLFxuICAgICAgICAgICAgICAgIHB1cnBvc2U6ICd0byBvcGVuJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogUGxhdGZvcm0uaXNNYWNPUyA/ICdjbWQgXHUyMUI1JyA6ICdjdHJsIFx1MjFCNScsXG4gICAgICAgICAgICAgICAgcHVycG9zZTogJ3RvIHJlcmFuaycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdlc2MnLFxuICAgICAgICAgICAgICAgIHB1cnBvc2U6ICd0byBkaXNtaXNzJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF1cbiAgICAgICAgdGhpcy5zZXRJbnN0cnVjdGlvbnMobW9kYWxJbnN0cnVjdGlvbnMpO1xuXG4gICAgICAgIC8vIFNldCBQbGFjZWhvbGRlciBUZXh0IGZvciBNb2RhbFxuICAgICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKCdTZWFyY2ggd2l0aCBLaG9qIFx1RDgzRVx1REQ4NS4uLicpO1xuICAgIH1cblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgaWYgKHRoaXMuZmluZF9zaW1pbGFyX25vdGVzKSB7XG4gICAgICAgICAgICAvLyBJZiBtYXJrZG93biBmaWxlIGlzIGN1cnJlbnRseSBhY3RpdmVcbiAgICAgICAgICAgIGxldCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgICAgIGlmIChmaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgLy8gRW5hYmxlIHJlcmFuayBvZiBzZWFyY2ggcmVzdWx0c1xuICAgICAgICAgICAgICAgIHRoaXMucmVyYW5rID0gdHJ1ZVxuICAgICAgICAgICAgICAgIC8vIFNldCBjb250ZW50cyBvZiBhY3RpdmUgbWFya2Rvd24gZmlsZSB0byBpbnB1dCBlbGVtZW50XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsLnZhbHVlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHNlYXJjaCB0byBnZXQgYW5kIHJlbmRlciBzaW1pbGFyIG5vdGVzIGZyb20ga2hvaiBiYWNrZW5kXG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpbnB1dCcpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcmFuayA9IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdENvbnRhaW5lckVsLnNldFRleHQoJ0Nhbm5vdCBmaW5kIHNpbWlsYXIgbm90ZXMgZm9yIG5vbi1tYXJrZG93biBmaWxlcycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IFByb21pc2U8U2VhcmNoUmVzdWx0W10+IHtcbiAgICAgICAgLy8gUXVlcnkgS2hvaiBiYWNrZW5kIGZvciBzZWFyY2ggcmVzdWx0c1xuICAgICAgICBsZXQgZW5jb2RlZFF1ZXJ5ID0gZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KTtcbiAgICAgICAgbGV0IHNlYXJjaFVybCA9IGAke3RoaXMuc2V0dGluZy5raG9qVXJsfS9hcGkvc2VhcmNoP3E9JHtlbmNvZGVkUXVlcnl9Jm49JHt0aGlzLnNldHRpbmcucmVzdWx0c0NvdW50fSZyPSR7dGhpcy5yZXJhbmt9JnQ9bWFya2Rvd25gXG4gICAgICAgIGxldCByZXN1bHRzID0gYXdhaXQgcmVxdWVzdChzZWFyY2hVcmwpXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiBKU09OLnBhcnNlKHJlc3BvbnNlKSlcbiAgICAgICAgICAgIC50aGVuKGRhdGEgPT4gZGF0YVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoKHJlc3VsdDogYW55KSA9PiAhdGhpcy5maW5kX3NpbWlsYXJfbm90ZXMgfHwgIXJlc3VsdC5hZGRpdGlvbmFsLmZpbGUuZW5kc1dpdGgodGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKT8ucGF0aCkpXG4gICAgICAgICAgICAgICAgLm1hcCgocmVzdWx0OiBhbnkpID0+IHsgcmV0dXJuIHsgZW50cnk6IHJlc3VsdC5lbnRyeSwgZmlsZTogcmVzdWx0LmFkZGl0aW9uYWwuZmlsZSB9IGFzIFNlYXJjaFJlc3VsdDsgfSkpO1xuXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cblxuICAgIGFzeW5jIHJlbmRlclN1Z2dlc3Rpb24ocmVzdWx0OiBTZWFyY2hSZXN1bHQsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBsZXQgd29yZHNfdG9fcmVuZGVyID0gMzA7XG4gICAgICAgIGxldCBlbnRyeV93b3JkcyA9IHJlc3VsdC5lbnRyeS5zcGxpdCgnICcpXG4gICAgICAgIGxldCBlbnRyeV9zbmlwcGVkX2luZGljYXRvciA9IGVudHJ5X3dvcmRzLmxlbmd0aCA+IHdvcmRzX3RvX3JlbmRlciA/ICcgKiouLi4qKicgOiAnJztcbiAgICAgICAgbGV0IHNuaXBwZWRfZW50cnkgPSBlbnRyeV93b3Jkcy5zbGljZSgwLCB3b3Jkc190b19yZW5kZXIpLmpvaW4oJyAnKTtcbiAgICAgICAgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihzbmlwcGVkX2VudHJ5ICsgZW50cnlfc25pcHBlZF9pbmRpY2F0b3IsIGVsLCBudWxsLCBudWxsKTtcbiAgICB9XG5cbiAgICBhc3luYyBvbkNob29zZVN1Z2dlc3Rpb24ocmVzdWx0OiBTZWFyY2hSZXN1bHQsIF86IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIC8vIEdldCBhbGwgbWFya2Rvd24gZmlsZXMgaW4gdmF1bHRcbiAgICAgICAgY29uc3QgbWRGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblxuICAgICAgICAvLyBGaW5kIHRoZSB2YXVsdCBmaWxlIG1hdGNoaW5nIGZpbGUgb2YgcmVzdWx0LiBPcGVuIGZpbGUgYXQgcmVzdWx0IGhlYWRpbmdcbiAgICAgICAgbWRGaWxlc1xuICAgICAgICAgICAgLy8gU29ydCBieSBkZXNjZW5kaW5nIGxlbmd0aCBvZiBwYXRoXG4gICAgICAgICAgICAvLyBUaGlzIGZpbmRzIGxvbmdlc3QgcGF0aCBtYXRjaCB3aGVuIG11bHRpcGxlIGZpbGVzIGhhdmUgc2FtZSBuYW1lXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5wYXRoLmxlbmd0aCAtIGEucGF0aC5sZW5ndGgpXG4gICAgICAgICAgICAuZm9yRWFjaCgoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEZpbmQgYmVzdCBmaWxlIG1hdGNoIGFjcm9zcyBvcGVyYXRpbmcgc3lzdGVtc1xuICAgICAgICAgICAgICAgIC8vIEUuZyBLaG9qIFNlcnZlciBvbiBMaW51eCwgT2JzaWRpYW4gVmF1bHQgb24gQW5kcm9pZFxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZmlsZS5lbmRzV2l0aChmaWxlLnBhdGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRIZWFkaW5nID0gcmVzdWx0LmVudHJ5LnNwbGl0KCdcXG4nLCAxKVswXTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxpbmtUb0VudHJ5ID0gYCR7ZmlsZS5wYXRofSR7cmVzdWx0SGVhZGluZ31gXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQobGlua1RvRW50cnksICcnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYExpbms6ICR7bGlua1RvRW50cnl9LCBGaWxlOiAke2ZpbGUucGF0aH0sIEhlYWRpbmc6ICR7cmVzdWx0SGVhZGluZ31gKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEZpbGVTeXN0ZW1BZGFwdGVyLCBOb3RpY2UsIFJlcXVlc3RVcmxQYXJhbSwgcmVxdWVzdCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtob2pTZXR0aW5nIH0gZnJvbSAnc3JjL3NldHRpbmdzJ1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmF1bHRBYnNvbHV0ZVBhdGgoKTogc3RyaW5nIHtcbiAgICBsZXQgYWRhcHRvciA9IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXI7XG4gICAgaWYgKGFkYXB0b3IgaW5zdGFuY2VvZiBGaWxlU3lzdGVtQWRhcHRlcikge1xuICAgICAgICByZXR1cm4gYWRhcHRvci5nZXRCYXNlUGF0aCgpO1xuICAgIH1cbiAgICByZXR1cm4gJyc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25maWd1cmVLaG9qQmFja2VuZChzZXR0aW5nOiBLaG9qU2V0dGluZywgbm90aWZ5OiBib29sZWFuID0gdHJ1ZSkge1xuICAgIGxldCBtZEluVmF1bHQgPSBgJHtnZXRWYXVsdEFic29sdXRlUGF0aCgpfS8qKi8qLm1kYDtcbiAgICBsZXQga2hvakNvbmZpZ1VybCA9IGAke3NldHRpbmcua2hvalVybH0vYXBpL2NvbmZpZy9kYXRhYDtcblxuICAgIC8vIENoZWNrIGlmIGtob2ogYmFja2VuZCBpcyBjb25maWd1cmVkLCBub3RlIGlmIGNhbm5vdCBjb25uZWN0IHRvIGJhY2tlbmRcbiAgICBsZXQga2hval9hbHJlYWR5X2NvbmZpZ3VyZWQgPSBhd2FpdCByZXF1ZXN0KGtob2pDb25maWdVcmwpXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIHNldHRpbmcuY29ubmVjdGVkVG9CYWNrZW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSAhPT0gXCJudWxsXCJcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgIHNldHRpbmcuY29ubmVjdGVkVG9CYWNrZW5kID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAobm90aWZ5KVxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc1N1x1RkUwRkVuc3VyZSBLaG9qIGJhY2tlbmQgaXMgcnVubmluZyBhbmQgS2hvaiBVUkwgaXMgcG9pbnRpbmcgdG8gaXQgaW4gdGhlIHBsdWdpbiBzZXR0aW5ncy5cXG5cXG4ke2Vycm9yfWApO1xuICAgICAgICB9KVxuICAgIC8vIFNob3J0LWNpcmN1aXQgY29uZmlndXJpbmcga2hvaiBpZiB1bmFibGUgdG8gY29ubmVjdCB0byBraG9qIGJhY2tlbmRcbiAgICBpZiAoIXNldHRpbmcuY29ubmVjdGVkVG9CYWNrZW5kKSByZXR1cm47XG5cbiAgICAvLyBTZXQgaW5kZXggbmFtZSBmcm9tIHRoZSBwYXRoIG9mIHRoZSBjdXJyZW50IHZhdWx0XG4gICAgbGV0IGluZGV4TmFtZSA9IGdldFZhdWx0QWJzb2x1dGVQYXRoKCkucmVwbGFjZSgvXFwvL2csICdfJykucmVwbGFjZSgvIC9nLCAnXycpO1xuICAgIC8vIEdldCBkZWZhdWx0IGluZGV4IGRpcmVjdG9yeSBmcm9tIGtob2ogYmFja2VuZFxuICAgIGxldCBraG9qRGVmYXVsdEluZGV4RGlyZWN0b3J5ID0gYXdhaXQgcmVxdWVzdChgJHtraG9qQ29uZmlnVXJsfS9kZWZhdWx0YClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gSlNPTi5wYXJzZShyZXNwb25zZSkpXG4gICAgICAgIC50aGVuKGRhdGEgPT4geyByZXR1cm4gZ2V0SW5kZXhEaXJlY3RvcnlGcm9tQmFja2VuZENvbmZpZyhkYXRhKTsgfSk7XG5cbiAgICAvLyBHZXQgY3VycmVudCBjb25maWcgaWYga2hvaiBiYWNrZW5kIGNvbmZpZ3VyZWQsIGVsc2UgZ2V0IGRlZmF1bHQgY29uZmlnIGZyb20ga2hvaiBiYWNrZW5kXG4gICAgYXdhaXQgcmVxdWVzdChraG9qX2FscmVhZHlfY29uZmlndXJlZCA/IGtob2pDb25maWdVcmwgOiBgJHtraG9qQ29uZmlnVXJsfS9kZWZhdWx0YClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gSlNPTi5wYXJzZShyZXNwb25zZSkpXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgLy8gSWYga2hvaiBiYWNrZW5kIG5vdCBjb25maWd1cmVkIHlldFxuICAgICAgICAgICAgaWYgKCFraG9qX2FscmVhZHlfY29uZmlndXJlZCkge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBraG9qIGNvbnRlbnQtdHlwZSBjb25maWcgd2l0aCBvbmx5IG1hcmtkb3duIGNvbmZpZ3VyZWRcbiAgICAgICAgICAgICAgICBkYXRhW1wiY29udGVudC10eXBlXCJdID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm1hcmtkb3duXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5wdXQtZmlsdGVyXCI6IFttZEluVmF1bHRdLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnB1dC1maWxlc1wiOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWJlZGRpbmdzLWZpbGVcIjogYCR7a2hvakRlZmF1bHRJbmRleERpcmVjdG9yeX0vJHtpbmRleE5hbWV9LnB0YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tcHJlc3NlZC1qc29ubFwiOiBgJHtraG9qRGVmYXVsdEluZGV4RGlyZWN0b3J5fS8ke2luZGV4TmFtZX0uanNvbmwuZ3pgLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIERpc2FibGUga2hvaiBwcm9jZXNzb3JzLCBhcyBub3QgcmVxdWlyZWRcbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YVtcInByb2Nlc3NvclwiXTtcblxuICAgICAgICAgICAgICAgIC8vIFNhdmUgbmV3IGNvbmZpZyBhbmQgcmVmcmVzaCBpbmRleCBvbiBraG9qIGJhY2tlbmRcbiAgICAgICAgICAgICAgICB1cGRhdGVLaG9qQmFja2VuZChzZXR0aW5nLmtob2pVcmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBLaG9qOiBDcmVhdGVkIGtob2ogYmFja2VuZCBjb25maWc6XFxuJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBFbHNlIGlmIGtob2ogY29uZmlnIGhhcyBubyBtYXJrZG93biBjb250ZW50IGNvbmZpZ1xuICAgICAgICAgICAgZWxzZSBpZiAoIWRhdGFbXCJjb250ZW50LXR5cGVcIl1bXCJtYXJrZG93blwiXSkge1xuICAgICAgICAgICAgICAgIC8vIEFkZCBtYXJrZG93biBjb25maWcgdG8ga2hvaiBjb250ZW50LXR5cGUgY29uZmlnXG4gICAgICAgICAgICAgICAgLy8gU2V0IG1hcmtkb3duIGNvbmZpZyB0byBpbmRleCBtYXJrZG93biBmaWxlcyBpbiBjb25maWd1cmVkIG9ic2lkaWFuIHZhdWx0XG4gICAgICAgICAgICAgICAgZGF0YVtcImNvbnRlbnQtdHlwZVwiXVtcIm1hcmtkb3duXCJdID0ge1xuICAgICAgICAgICAgICAgICAgICBcImlucHV0LWZpbHRlclwiOiBbbWRJblZhdWx0XSxcbiAgICAgICAgICAgICAgICAgICAgXCJpbnB1dC1maWxlc1wiOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBcImVtYmVkZGluZ3MtZmlsZVwiOiBgJHtraG9qRGVmYXVsdEluZGV4RGlyZWN0b3J5fS8ke2luZGV4TmFtZX0ucHRgLFxuICAgICAgICAgICAgICAgICAgICBcImNvbXByZXNzZWQtanNvbmxcIjogYCR7a2hvakRlZmF1bHRJbmRleERpcmVjdG9yeX0vJHtpbmRleE5hbWV9Lmpzb25sLmd6YCxcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTYXZlIHVwZGF0ZWQgY29uZmlnIGFuZCByZWZyZXNoIGluZGV4IG9uIGtob2ogYmFja2VuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUtob2pCYWNrZW5kKHNldHRpbmcua2hvalVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEtob2o6IEFkZGVkIG1hcmtkb3duIGNvbmZpZyB0byBraG9qIGJhY2tlbmQgY29uZmlnOlxcbiR7SlNPTi5zdHJpbmdpZnkoZGF0YVtcImNvbnRlbnQtdHlwZVwiXSl9YClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRWxzZSBpZiBraG9qIGlzIG5vdCBjb25maWd1cmVkIHRvIGluZGV4IG1hcmtkb3duIGZpbGVzIGluIGNvbmZpZ3VyZWQgb2JzaWRpYW4gdmF1bHRcbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGFbXCJjb250ZW50LXR5cGVcIl1bXCJtYXJrZG93blwiXVtcImlucHV0LWZpbHRlclwiXS5sZW5ndGggIT0gMSB8fFxuICAgICAgICAgICAgICAgIGRhdGFbXCJjb250ZW50LXR5cGVcIl1bXCJtYXJrZG93blwiXVtcImlucHV0LWZpbHRlclwiXVswXSAhPT0gbWRJblZhdWx0KSB7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIG1hcmtkb3duIGNvbmZpZyBpbiBraG9qIGNvbnRlbnQtdHlwZSBjb25maWdcbiAgICAgICAgICAgICAgICAvLyBTZXQgbWFya2Rvd24gY29uZmlnIHRvIG9ubHkgaW5kZXggbWFya2Rvd24gZmlsZXMgaW4gY29uZmlndXJlZCBvYnNpZGlhbiB2YXVsdFxuICAgICAgICAgICAgICAgIGxldCBraG9qSW5kZXhEaXJlY3RvcnkgPSBnZXRJbmRleERpcmVjdG9yeUZyb21CYWNrZW5kQ29uZmlnKGRhdGEpO1xuICAgICAgICAgICAgICAgIGRhdGFbXCJjb250ZW50LXR5cGVcIl1bXCJtYXJrZG93blwiXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJpbnB1dC1maWx0ZXJcIjogW21kSW5WYXVsdF0sXG4gICAgICAgICAgICAgICAgICAgIFwiaW5wdXQtZmlsZXNcIjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgXCJlbWJlZGRpbmdzLWZpbGVcIjogYCR7a2hvakluZGV4RGlyZWN0b3J5fS8ke2luZGV4TmFtZX0ucHRgLFxuICAgICAgICAgICAgICAgICAgICBcImNvbXByZXNzZWQtanNvbmxcIjogYCR7a2hvakluZGV4RGlyZWN0b3J5fS8ke2luZGV4TmFtZX0uanNvbmwuZ3pgLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBTYXZlIHVwZGF0ZWQgY29uZmlnIGFuZCByZWZyZXNoIGluZGV4IG9uIGtob2ogYmFja2VuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUtob2pCYWNrZW5kKHNldHRpbmcua2hvalVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEtob2o6IFVwZGF0ZWQgbWFya2Rvd24gY29uZmlnIGluIGtob2ogYmFja2VuZCBjb25maWc6XFxuJHtKU09OLnN0cmluZ2lmeShkYXRhW1wiY29udGVudC10eXBlXCJdW1wibWFya2Rvd25cIl0pfWApXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICBpZiAobm90aWZ5KVxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc1N1x1RkUwRkZhaWxlZCB0byBjb25maWd1cmUgS2hvaiBiYWNrZW5kLiBDb250YWN0IGRldmVsb3BlciBvbiBHaXRodWIuXFxuXFxuRXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgICAgIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVLaG9qQmFja2VuZChraG9qVXJsOiBzdHJpbmcsIGtob2pDb25maWc6IE9iamVjdCkge1xuICAgIC8vIFBPU1Qga2hvakNvbmZpZyB0byBraG9qQ29uZmlnVXJsXG4gICAgbGV0IHJlcXVlc3RDb250ZW50OiBSZXF1ZXN0VXJsUGFyYW0gPSB7XG4gICAgICAgIHVybDogYCR7a2hvalVybH0vYXBpL2NvbmZpZy9kYXRhYCxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoa2hvakNvbmZpZyksXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgIH07XG5cbiAgICAvLyBTYXZlIGtob2pDb25maWcgb24ga2hvaiBiYWNrZW5kIGF0IGtob2pDb25maWdVcmxcbiAgICBhd2FpdCByZXF1ZXN0KHJlcXVlc3RDb250ZW50KVxuICAgICAgICAvLyBSZWZyZXNoIGtob2ogc2VhcmNoIGluZGV4IGFmdGVyIHVwZGF0aW5nIGNvbmZpZ1xuICAgICAgICAudGhlbihfID0+IHJlcXVlc3QoYCR7a2hvalVybH0vYXBpL3VwZGF0ZT90PW1hcmtkb3duYCkpO1xufVxuXG5mdW5jdGlvbiBnZXRJbmRleERpcmVjdG9yeUZyb21CYWNrZW5kQ29uZmlnKGtob2pDb25maWc6IGFueSkge1xuICAgIHJldHVybiBraG9qQ29uZmlnW1wiY29udGVudC10eXBlXCJdW1wibWFya2Rvd25cIl1bXCJlbWJlZGRpbmdzLWZpbGVcIl0uc3BsaXQoXCIvXCIpLnNsaWNlKDAsIC0xKS5qb2luKFwiL1wiKTtcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQStCOzs7QUNBL0Isc0JBQWdFO0FBU3pELElBQU0sbUJBQWdDO0FBQUEsRUFDekMsY0FBYztBQUFBLEVBQ2QsU0FBUztBQUFBLEVBQ1Qsb0JBQW9CO0FBQ3hCO0FBRU8sSUFBTSxpQkFBTixjQUE2QixpQ0FBaUI7QUFBQSxFQUdqRCxZQUFZLEtBQVUsUUFBYztBQUNoQyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNsQjtBQUFBLEVBRUEsVUFBZ0I7QUFDWixVQUFNLEVBQUUsZ0JBQWdCO0FBQ3hCLGdCQUFZLE1BQU07QUFHbEIsZ0JBQVksU0FBUyxTQUFTLEVBQUUsTUFBTSxLQUFLLHdCQUF3QixFQUFFLENBQUM7QUFHdEUsUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsVUFBVSxFQUNsQixRQUFRLDZCQUE2QixFQUNyQyxRQUFRLFVBQVEsS0FDWixTQUFTLEdBQUcsS0FBSyxPQUFPLFNBQVMsU0FBUyxFQUMxQyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxVQUFVLE1BQU0sS0FBSztBQUMxQyxZQUFNLEtBQUssT0FBTyxhQUFhLEVBQzlCLFFBQVEsTUFBRztBQXZDaEM7QUF1Q21DLGlDQUFZLHNCQUFaLG1CQUErQixRQUFRLEtBQUssd0JBQXdCO0FBQUEsT0FBRTtBQUFBLElBQ3pGLENBQUMsQ0FBQztBQUNULFFBQUksd0JBQVEsV0FBVyxFQUNuQixRQUFRLGVBQWUsRUFDdkIsUUFBUSxzQ0FBc0MsRUFDOUMsVUFBVSxZQUFVLE9BQ2hCLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFDbEIsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLEVBQzFDLGtCQUFrQixFQUNsQixTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFDVixRQUFJLG9CQUFvQixJQUFJLHdCQUFRLFdBQVc7QUFDL0Msc0JBQ0ssUUFBUSxhQUFhLEVBQ3JCLFFBQVEscURBQXFELEVBQzdELFVBQVUsWUFBVSxPQUNoQixjQUFjLFFBQVEsRUFDdEIsT0FBTyxFQUNQLFFBQVEsWUFBWTtBQUVqQixhQUFPLGNBQWMsYUFBYTtBQUNsQyxhQUFPLFVBQVU7QUFDakIsMEJBQW9CLGtCQUFrQixZQUFZLElBQUk7QUFFdEQsWUFBTSw2QkFBUSxHQUFHLEtBQUssT0FBTyxTQUFTLDBDQUEwQyxFQUMvRSxLQUFLLE1BQU0sSUFBSSx1QkFBTyw0QkFBdUIsQ0FBQztBQUcvQyxhQUFPLGNBQWMsUUFBUTtBQUM3QixhQUFPLE9BQU87QUFDZCwwQkFBb0Isa0JBQWtCLFlBQVksS0FBSztBQUFBLElBQzNELENBQUMsQ0FDTDtBQUFBLEVBQ1I7QUFBQSxFQUVBLDBCQUEwQjtBQUN0QixXQUFPLENBQUMsS0FBSyxPQUFPLFNBQVMscUJBQzNCLDhHQUNBO0FBQUEsRUFDTjtBQUNKOzs7QUNqRkEsdUJBQW9GO0FBUTdFLElBQU0sWUFBTixjQUF3Qiw4QkFBMkI7QUFBQSxFQUt0RCxZQUFZLEtBQVUsU0FBc0IscUJBQThCLE9BQU87QUFDN0UsVUFBTSxHQUFHO0FBSmIsa0JBQWtCO0FBS2QsU0FBSyxVQUFVO0FBQ2YsU0FBSyxxQkFBcUI7QUFHMUIsU0FBSyxRQUFRLFNBQVMsS0FBSztBQUczQixTQUFLLE1BQU0sU0FBUyxDQUFDLEtBQUssR0FBRyxTQUFTLFlBQVk7QUFFOUMsV0FBSyxTQUFTO0FBRWQsV0FBSyxRQUFRLGNBQWMsSUFBSSxNQUFNLE9BQU8sQ0FBQztBQUU3QyxXQUFLLFNBQVM7QUFBQSxJQUNsQixDQUFDO0FBR0QsVUFBTSxvQkFBbUM7QUFBQSxNQUNyQztBQUFBLFFBQ0ksU0FBUztBQUFBLFFBQ1QsU0FBUztBQUFBLE1BQ2I7QUFBQSxNQUNBO0FBQUEsUUFDSSxTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsTUFDYjtBQUFBLE1BQ0E7QUFBQSxRQUNJLFNBQVMsMEJBQVMsVUFBVSxlQUFVO0FBQUEsUUFDdEMsU0FBUztBQUFBLE1BQ2I7QUFBQSxNQUNBO0FBQUEsUUFDSSxTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsTUFDYjtBQUFBLElBQ0o7QUFDQSxTQUFLLGdCQUFnQixpQkFBaUI7QUFHdEMsU0FBSyxlQUFlLCtCQUF3QjtBQUFBLEVBQ2hEO0FBQUEsRUFFQSxNQUFNLFNBQVM7QUFDWCxRQUFJLEtBQUssb0JBQW9CO0FBRXpCLFVBQUksT0FBTyxLQUFLLElBQUksVUFBVSxjQUFjO0FBQzVDLFVBQUksUUFBUSxLQUFLLGNBQWMsTUFBTTtBQUVqQyxhQUFLLFNBQVM7QUFFZCxhQUFLLFFBQVEsUUFBUSxNQUFNLEtBQUssSUFBSSxNQUFNLEtBQUssSUFBSTtBQUVuRCxhQUFLLFFBQVEsY0FBYyxJQUFJLE1BQU0sT0FBTyxDQUFDO0FBQzdDLGFBQUssU0FBUztBQUFBLE1BQ2xCLE9BQ0s7QUFDRCxhQUFLLGtCQUFrQixRQUFRLGtEQUFrRDtBQUFBLE1BQ3JGO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQU0sZUFBZSxPQUF3QztBQUV6RCxRQUFJLGVBQWUsbUJBQW1CLEtBQUs7QUFDM0MsUUFBSSxZQUFZLEdBQUcsS0FBSyxRQUFRLHdCQUF3QixrQkFBa0IsS0FBSyxRQUFRLGtCQUFrQixLQUFLO0FBQzlHLFFBQUksVUFBVSxNQUFNLDhCQUFRLFNBQVMsRUFDaEMsS0FBSyxjQUFZLEtBQUssTUFBTSxRQUFRLENBQUMsRUFDckMsS0FBSyxVQUFRLEtBQ1QsT0FBTyxDQUFDLFdBQWE7QUFsRnRDO0FBa0Z5QyxjQUFDLEtBQUssc0JBQXNCLENBQUMsT0FBTyxXQUFXLEtBQUssU0FBUyxXQUFLLElBQUksVUFBVSxjQUFjLE1BQWpDLG1CQUFvQyxJQUFJO0FBQUEsS0FBQyxFQUM5SCxJQUFJLENBQUMsV0FBZ0I7QUFBRSxhQUFPLEVBQUUsT0FBTyxPQUFPLE9BQU8sTUFBTSxPQUFPLFdBQVcsS0FBSztBQUFBLElBQW1CLENBQUMsQ0FBQztBQUVoSCxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsTUFBTSxpQkFBaUIsUUFBc0IsSUFBaUI7QUFDMUQsUUFBSSxrQkFBa0I7QUFDdEIsUUFBSSxjQUFjLE9BQU8sTUFBTSxNQUFNLEdBQUc7QUFDeEMsUUFBSSwwQkFBMEIsWUFBWSxTQUFTLGtCQUFrQixhQUFhO0FBQ2xGLFFBQUksZ0JBQWdCLFlBQVksTUFBTSxHQUFHLGVBQWUsRUFBRSxLQUFLLEdBQUc7QUFDbEUsc0NBQWlCLGVBQWUsZ0JBQWdCLHlCQUF5QixJQUFJLE1BQU0sSUFBSTtBQUFBLEVBQzNGO0FBQUEsRUFFQSxNQUFNLG1CQUFtQixRQUFzQixHQUErQjtBQUUxRSxVQUFNLFVBQVUsS0FBSyxJQUFJLE1BQU0saUJBQWlCO0FBR2hELFlBR0ssS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLEtBQUssU0FBUyxFQUFFLEtBQUssTUFBTSxFQUM1QyxRQUFRLENBQUMsU0FBUztBQUdmLFVBQUksT0FBTyxLQUFLLFNBQVMsS0FBSyxJQUFJLEdBQUc7QUFDakMsWUFBSSxnQkFBZ0IsT0FBTyxNQUFNLE1BQU0sTUFBTSxDQUFDLEVBQUU7QUFDaEQsWUFBSSxjQUFjLEdBQUcsS0FBSyxPQUFPO0FBQ2pDLGFBQUssSUFBSSxVQUFVLGFBQWEsYUFBYSxFQUFFO0FBQy9DLGdCQUFRLElBQUksU0FBUyxzQkFBc0IsS0FBSyxrQkFBa0IsZUFBZTtBQUNqRjtBQUFBLE1BQ0o7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNUO0FBQ0o7OztBQ3JIQSx1QkFBb0U7QUFHN0QsZ0NBQXdDO0FBQzNDLE1BQUksVUFBVSxLQUFLLElBQUksTUFBTTtBQUM3QixNQUFJLG1CQUFtQixvQ0FBbUI7QUFDdEMsV0FBTyxRQUFRLFlBQVk7QUFBQSxFQUMvQjtBQUNBLFNBQU87QUFDWDtBQUVBLG9DQUEyQyxTQUFzQixTQUFrQixNQUFNO0FBQ3JGLE1BQUksWUFBWSxHQUFHLHFCQUFxQjtBQUN4QyxNQUFJLGdCQUFnQixHQUFHLFFBQVE7QUFHL0IsTUFBSSwwQkFBMEIsTUFBTSw4QkFBUSxhQUFhLEVBQ3BELEtBQUssY0FBWTtBQUNkLFlBQVEscUJBQXFCO0FBQzdCLFdBQU8sYUFBYTtBQUFBLEVBQ3hCLENBQUMsRUFDQSxNQUFNLFdBQVM7QUFDWixZQUFRLHFCQUFxQjtBQUM3QixRQUFJO0FBQ0EsVUFBSSx3QkFBTztBQUFBO0FBQUEsRUFBOEYsT0FBTztBQUFBLEVBQ3hILENBQUM7QUFFTCxNQUFJLENBQUMsUUFBUTtBQUFvQjtBQUdqQyxNQUFJLFlBQVkscUJBQXFCLEVBQUUsUUFBUSxPQUFPLEdBQUcsRUFBRSxRQUFRLE1BQU0sR0FBRztBQUU1RSxNQUFJLDRCQUE0QixNQUFNLDhCQUFRLEdBQUcsdUJBQXVCLEVBQ25FLEtBQUssY0FBWSxLQUFLLE1BQU0sUUFBUSxDQUFDLEVBQ3JDLEtBQUssVUFBUTtBQUFFLFdBQU8sbUNBQW1DLElBQUk7QUFBQSxFQUFHLENBQUM7QUFHdEUsUUFBTSw4QkFBUSwwQkFBMEIsZ0JBQWdCLEdBQUcsdUJBQXVCLEVBQzdFLEtBQUssY0FBWSxLQUFLLE1BQU0sUUFBUSxDQUFDLEVBQ3JDLEtBQUssVUFBUTtBQUVWLFFBQUksQ0FBQyx5QkFBeUI7QUFFMUIsV0FBSyxrQkFBa0I7QUFBQSxRQUNuQixZQUFZO0FBQUEsVUFDUixnQkFBZ0IsQ0FBQyxTQUFTO0FBQUEsVUFDMUIsZUFBZTtBQUFBLFVBQ2YsbUJBQW1CLEdBQUcsNkJBQTZCO0FBQUEsVUFDbkQsb0JBQW9CLEdBQUcsNkJBQTZCO0FBQUEsUUFDeEQ7QUFBQSxNQUNKO0FBRUEsYUFBTyxLQUFLO0FBR1osd0JBQWtCLFFBQVEsU0FBUyxJQUFJO0FBQ3ZDLGNBQVEsSUFBSTtBQUFBLEVBQXVDLEtBQUssVUFBVSxJQUFJLEdBQUc7QUFBQSxJQUM3RSxXQUdTLENBQUMsS0FBSyxnQkFBZ0IsYUFBYTtBQUd4QyxXQUFLLGdCQUFnQixjQUFjO0FBQUEsUUFDL0IsZ0JBQWdCLENBQUMsU0FBUztBQUFBLFFBQzFCLGVBQWU7QUFBQSxRQUNmLG1CQUFtQixHQUFHLDZCQUE2QjtBQUFBLFFBQ25ELG9CQUFvQixHQUFHLDZCQUE2QjtBQUFBLE1BQ3hEO0FBR0Esd0JBQWtCLFFBQVEsU0FBUyxJQUFJO0FBQ3ZDLGNBQVEsSUFBSTtBQUFBLEVBQXdELEtBQUssVUFBVSxLQUFLLGVBQWUsR0FBRztBQUFBLElBQzlHLFdBR1MsS0FBSyxnQkFBZ0IsWUFBWSxnQkFBZ0IsVUFBVSxLQUNoRSxLQUFLLGdCQUFnQixZQUFZLGdCQUFnQixPQUFPLFdBQVc7QUFHbkUsVUFBSSxxQkFBcUIsbUNBQW1DLElBQUk7QUFDaEUsV0FBSyxnQkFBZ0IsY0FBYztBQUFBLFFBQy9CLGdCQUFnQixDQUFDLFNBQVM7QUFBQSxRQUMxQixlQUFlO0FBQUEsUUFDZixtQkFBbUIsR0FBRyxzQkFBc0I7QUFBQSxRQUM1QyxvQkFBb0IsR0FBRyxzQkFBc0I7QUFBQSxNQUNqRDtBQUVBLHdCQUFrQixRQUFRLFNBQVMsSUFBSTtBQUN2QyxjQUFRLElBQUk7QUFBQSxFQUEwRCxLQUFLLFVBQVUsS0FBSyxnQkFBZ0IsV0FBVyxHQUFHO0FBQUEsSUFDNUg7QUFBQSxFQUNKLENBQUMsRUFDQSxNQUFNLFdBQVM7QUFDWixRQUFJO0FBQ0EsVUFBSSx3QkFBTztBQUFBO0FBQUEsU0FBOEUsT0FBTztBQUFBLEVBQ3hHLENBQUM7QUFDVDtBQUVBLGlDQUF3QyxTQUFpQixZQUFvQjtBQUV6RSxNQUFJLGlCQUFrQztBQUFBLElBQ2xDLEtBQUssR0FBRztBQUFBLElBQ1IsTUFBTSxLQUFLLFVBQVUsVUFBVTtBQUFBLElBQy9CLFFBQVE7QUFBQSxJQUNSLGFBQWE7QUFBQSxFQUNqQjtBQUdBLFFBQU0sOEJBQVEsY0FBYyxFQUV2QixLQUFLLE9BQUssOEJBQVEsR0FBRywrQkFBK0IsQ0FBQztBQUM5RDtBQUVBLDRDQUE0QyxZQUFpQjtBQUN6RCxTQUFPLFdBQVcsZ0JBQWdCLFlBQVksbUJBQW1CLE1BQU0sR0FBRyxFQUFFLE1BQU0sR0FBRyxFQUFFLEVBQUUsS0FBSyxHQUFHO0FBQ3JHOzs7QUg3R0EsSUFBcUIsT0FBckIsY0FBa0Msd0JBQU87QUFBQSxFQUdyQyxNQUFNLFNBQVM7QUFDWCxVQUFNLEtBQUssYUFBYTtBQUd4QixTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLGVBQWUsQ0FBQyxhQUFhO0FBQ3pCLFlBQUksQ0FBQyxZQUFZLEtBQUssU0FBUztBQUMzQixjQUFJLFVBQVUsS0FBSyxLQUFLLEtBQUssUUFBUSxFQUFFLEtBQUs7QUFDaEQsZUFBTyxLQUFLLFNBQVM7QUFBQSxNQUN6QjtBQUFBLElBQ0osQ0FBQztBQUdELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04scUJBQXFCLENBQUMsYUFBYTtBQUMvQixZQUFJLENBQUMsWUFBWSxLQUFLLFNBQVM7QUFDM0IsY0FBSSxVQUFVLEtBQUssS0FBSyxLQUFLLFVBQVUsSUFBSSxFQUFFLEtBQUs7QUFDdEQsZUFBTyxLQUFLLFNBQVM7QUFBQSxNQUN6QjtBQUFBLElBQ0osQ0FBQztBQUdELFNBQUssY0FBYyxVQUFVLFFBQVEsQ0FBQyxNQUFrQjtBQUVwRCxXQUFLLFNBQVMscUJBQ1IsSUFBSSxVQUFVLEtBQUssS0FBSyxLQUFLLFFBQVEsRUFBRSxLQUFLLElBQzVDLElBQUksd0JBQU8sa0dBQXdGO0FBQUEsSUFDN0csQ0FBQztBQUdELFNBQUssY0FBYyxJQUFJLGVBQWUsS0FBSyxLQUFLLElBQUksQ0FBQztBQUFBLEVBQ3pEO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFFakIsU0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLE1BQU0sS0FBSyxTQUFTLENBQUM7QUFHekUsVUFBTSxxQkFBcUIsS0FBSyxRQUFRO0FBQUEsRUFDNUM7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLHFCQUFxQixLQUFLLFVBQVUsS0FBSyxFQUMxQyxLQUFLLE1BQU0sS0FBSyxTQUFTLEtBQUssUUFBUSxDQUFDO0FBQUEsRUFDaEQ7QUFDSjsiLAogICJuYW1lcyI6IFtdCn0K
